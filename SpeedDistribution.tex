\chapter{Parametrising the WIMP distribution}
\label{ch:Speed}

%\chapterprecishere{}

%\note{Need to shorten a little - about 500 words...?}

As we have explored in Chapter~\ref{ch:DD}, there are a number of uncertainties associated with calculating the direct detection event rate. These translate directly into uncertainties in the analysis of direct detection results, present and future. If these uncertainties are properly accounted for, they can provide more realistic estimates of uncertainties on the WIMP cross sections \sigmapsi and \sigmapsd and WIMP mass \mchi. If, however, our assumptions do not reflect the underlying nuclear physics, particle physics or astrophysics of dark matter, this can lead to a bias in the WIMP parameters. Understanding these uncertainties and how to mitigate them is therefore of great importance.

The WIMP speed distribution $f_1(v)$ enters into the direct detection event rate as it influences both the typical flux of dark matter particles and the typical recoil energy imparted during a scattering event. Unfortunately, the typical flux and recoil energy are also strongly dependent on the WIMP mass \mchi. This leads to a strong degeneracy between \mchi and $f_1(v)$ and, as discussed in Sec.~\ref{sec:DD:astrounc}, the possibility of significant bias in the reconstruction of the WIMP mass.

Because the speed distribution is so poorly constrained, an ideal goal would be to construct the most general parametrisation for $f_1(v)$ which can accommodate a wide range of possibilities for the true functional form. In Sec.~\ref{sec:Speed:attempts}, we explore previous attempts in the literature to account for uncertainties in the speed distribution and consider the properties which are required of any parametrisation of the speed distribution. A very general approach was explored by Peter \cite{Peter:2011}, who wrote down an empirical parametrisation for $f(v)$ as a series of constant bins in $v$. However, this still resulted in a bias in the reconstructed WIMP parameters. In Sec.~\ref{sec:Speed:binned}, we analyse in more detail the performance of this method and attempt to explain where this bias comes from.

In Sec.~\ref{sec:Speed:MomentumMethod1} and Sec.~\ref{sec:Speed:MomentumMethod2}, we discuss a method analogous to that of Peter but for parametrising the WIMP \textit{momentum} distribution in terms of a series of constant bins. This transformation helps remove some of the degeneracy between the WIMP mass and distribution function and improves reconstructions of the mass compared to binning in $f(v)$. We also discuss how the speed distribution can be extracted from the momentum parameters. Finally, we discuss the weaknesses of this momentum parametrisation, highlighting where remaining work is needed.

%In Sec.~\ref{sec:Speed:poly}, we propose an alternative parametrisation. Instead of parametrising $f(v)$, we parametrise the logarithm of $f(v)$ as a series of polynomials. This permits the most general possible form from $f(v)$ satisfying the constraint $f(v) \geq 0$. We demonstrate the performance of this new method over a range of WIMP masses and over a range of underlying speed distributions and experimental parameters. We show that this method allows us to reconstruct the WIMP mass without bias, as well as allowing us to reconstruct information about the WIMP speed distribution itself. \note{What about doing some 1-D plots for $f(v)$ parameters, such as plotting $\langle v \rangle$ or similar...?}


\section{Attempts to address the uncertainties in $f_1(v)$}
\label{sec:Speed:attempts}

Direct detection experiments are typically analysed within the framework of the Standard Halo Model (SHM), described in Chapter~\ref{ch:DD}. A first step in extending the SHM is to incorporate uncertainties in $v_\textrm{lag}$, $\sigma_v$ and $v_\textrm{esc}$ in reconstructions. Strigari and Trotta \cite{Strigari:2009} introduced a simple model of the Milky Way mass distribution, from which SHM velocity parameters can be derived. They then use projected stellar kinematics and direct detection data to fit both the model parameters and the dark matter properties. A more direct approach is to directly fit the SHM velocity parameters, incorporating their uncertainties into the fitting likelihood. This method has been considered by Peter \cite{Peter:2010}, and is typically used as a simple model of astrophysical uncertainties (especially in studies which focus on other aspects of direct detection, e.g.\ Ref.~\cite{Arina:2013}). These methods allow bias in the reconstructed WIMP parameters to be eliminated when the underlying speed distribution is indeed in the SHM form. However, as shown by Peter \cite{Peter:2011}, these methods fail when the distribution function differs from the standard Maxwellian case.

There have also been attempts to incorporate and fit more realistic distribution functions. Pato et al. \cite{Pato:2011} incorporate astrophysical uncertainties by using the distribution function of Lisanti et al. \cite{Lisanti:2010} and fitting the various shape parameters associated with it. In a more recent paper, Pato et al. \cite{Pato:2013} use projected direct detection data and stellar kinematics data to fit a model of the Milky Way mass distribution, from which they derive a self-consistent distribution function (SCDF) using Eddington's formula. This means that the resulting speed distribution will be consistent with the underlying potentials of the galaxy's bulge, disk and dark matter, incorporating a broader range of shapes than the SHM alone. However, as the authors point out, velocity distributions from cosmological N-body simulations differ significantly from those expected from Eddington's formula. As with the Standard Halo Model, fitting such a SCDF is likely to result in biased reconstructions if the true distribution deviates significantly from the functional form used for fitting.

Methods which make no assumptions about the functional form of the speed distribution have had mixed success. Drees and Shan \cite{Drees:2007, Drees:2008} developed a method for estimating the WIMP mass by calculating moments of the speed distribution. However, this method still introduces a bias into the reconstructed WIMP mass and performs more poorly for heavier WIMPs and when finite energy thresholds are considered. An empirical ansatz for the speed distribution has also been suggested, specifically dividing the WIMP speed into a series of bins, with the distribution being constant within each bin \cite{Peter:2011}. However, this still results in a significant bias in the reconstructed mass and cross section. A recent proposal by Feldstein and Kahlhoefer \cite{Feldstein:2014} is to fit the velocity \textit{integral} rather than the speed distribution. This proposal is the most promising so far and appears to give an unbiased reconstruction of the mass. However, the method has not been demonstrated for low mass WIMPs and reconstructing the speed distribution itself remains problematic.

Finally, a method for comparing existing data has been developed by various authors \cite{Fox:2011b,Frandsen:2012, Gondolo:2012}. At a given mass, a given experiment is sensitive only to speeds in a fixed range, set by $v_\textrm{min}(E_\textrm{min})$ and $v_\textrm{min}(E_\textrm{max})$. By considering only the range of speeds where two or more experiments overlap, one can ensure that the astrophysical contribution to both experiments is equal. This method has typically been used to assess the compatibility of different data sets and to set more robust limits on the WIMP interaction cross sections. Recently it has also been extended to accomodate more general forms for the WIMP interactions \cite{DelNobile:2013}.
%\note{Again, be more specific - actually read these papers and put in some more detail - if it has to spill over into another chapter then fine... - Not sure, which is the McCabe one...}

\subsection{Considerations in parametrising $f_1(v)$}


Given the range of possibilities for the form of the speed distribution, we want to consider parametrisations which are as general as possible. We discuss now some of the challenges and considerations which must be taken into account for such parametrisations. We can write the integral over the speed distribution as
\begin{equation}
\label{eq:Speed:eta}
\eta(\vmin) \equiv \int_{\vmin}^\infty \frac{f_1(v)}{v}\,\mathrm{d}v\,,
\end{equation}
where \vmin is given by
\begin{equation}
v_\textrm{min} = v_\textrm{min}(E_R, \mchi, m_N) = \sqrt{\frac{m_N E_R}{2 \mu_{\chi N}^2}}\,.
\end{equation}
If we treat $f_1(v)$ as a free function (subject to the condition that it be normalised to unity and everywhere positive), this is equivalent to treating $\eta(\vmin)$ as a free function (subject to the equivalent condition that $\eta$ be a monotonically decreasing function of \vmin). This represents an entirely agnostic approach to $f_1(v)$, assuming that we know nothing at all about its functional form. Unfortunately, if we fix $m_N$, any change in $\mchi$ (and resulting change in \vmin) can be counteracted by a change in the form of $\eta$, leading to the same spectral shape $\eta(E_R)$. This means that for a single experiment, the WIMP mass and $f(v)$ are degenerate and we need multiple experiments to disentangle the two \cite{Drees:2008}. We will phrase this in more concrete terms later in Sec.~\ref{sec:Speed:MomentumMethod1}.

Another consideration when parametrising $f_1(v)$ is the range of sensitivity of the experiments. Each experiment will have a window of recoil energies to which it is sensitive $\left[\Emin, \Emax\right]$ (though the recoil detection efficiency may vary across this window). This means that for a given WIMP mass, each experiment will be sensitive only a range of WIMP speeds $\left[\vmin(\Emin), \vmin(\Emax)\right]$. WIMPs with speeds smaller than $\vmin(\Emin)$ do not contribute to the velocity integral defined in Eq.~\ref{eq:Speed:eta}. WIMPs with speeds above $\vmin(\Emax)$ can contribute to the overall spectrum, but they contribute only a constant, additive rate; the experiment is not sensitive to the \textit{shape} of the speed distribution above this maximum speed. If we wish to probe the shape of $f_1(v)$, the range of speeds probed by each experiment must have some overlap. Otherwise, $f_1(v)$ can be varied independently across each speed range and the degeneracy between \mchi and $f_1(v)$ remains.

In order to get a handle on $f_1(v)$ (and simultaneously the WIMP mass and cross sections) we therefore need several direct detection experiments, which use different target materials but which probe overlapping WIMP speeds. However, we must come up with a way of writing our general function $f_1(v)$ which allows us to reconstruct it by fitting to the data. Such a parametrisation should correspond to a physical distribution function. This gives two important conditions on the speed distribution:

\begin{enumerate}[(i)]

\item it should be normalised to unity

\begin{equation}
\int_0^\infty f_1(v) \, \textrm{d}v = 1\,,
\end{equation}

\item and it should be everywhere positive

\begin{equation}
f_1(v) \geq 0 \textrm{ for all  } v\,.
\end{equation}
\end{enumerate}
Subject to these constraints, we should try to write down a parametrisation which spans a wide range of underlying distribution functions and which does not introduce any additional bias into attempts to reconstruct the WIMP parameters. For this reason, it is necessary to carefully test any proposed parametrisation. We now explore in more detail several proposals for what such a general parametrisation could look like.

\section{Binned speed distribution}
\label{sec:Speed:binned}
Peter proposed the use of an empirical speed distribution in the form of a series of bins in speed $v$ in order to fit to data. Explicitly, we write the directionally-averaged velocity distribution (in the Earth frame), as a series of \(N\) bins of constant value, with bin edges \(\{ \tilde{v}_i\}\):

\begin{equation}
\label{eq:Speed:binned}
f(v) = \sum_{i = 1}^N g_i \, W(v;\tilde{v}_i,\Delta v) \,,
\end{equation}
where the top-hat function, W, is defined as:

\begin{equation}
W(v;\tilde{v}_i,\Delta v) =
\begin{cases}
   1 &  v \in [\tilde{v}_i,\tilde{v}_i+\Delta v]\,, \\
   0  & \text{otherwise}\,.
  \end{cases}
\end{equation}
We must choose a maximum speed $v_\textrm{max} = N\Delta v$ up to which we parametrise. Beyond this speed, we set $f(v)$ to zero, so we should choose a conservative value which does not risk truncating the speed distribution prematurely. Based on the results of the RAVE surveys \cite{RAVE:2007, RAVE:2014}, the Galactic escape speed is estimated to be $\vesc < 587 \kms$ at the 90\% confidence level. Assuming a local circular speed of $v_c \sim 220 \kms$ \cite{Kerr:1986,Feast:1997}, this means that in the Earth frame, particles with speeds significantly higher than $v_c + \vesc \sim 800 \kms$ should not be gravitationally bound. This is consistent with results for the local escape speed obtained in N-body simulations \cite{Kuhlen:2010}. We therefore choose a value $v_\textrm{max} = 1000 \kms$ as a conservative upper limit for the parametrisation.

The form for the distribution function given in Eq.~\ref{eq:Speed:binned} is the directionally-averaged WIMP velocity distribution, $f(v)$. The WIMP \textit{speed} distribution is then given by

\begin{equation}
\label{eq:Speed:binned2}
f_1(v) = \sum_{i = 1}^N g_i v^2\, W(v;\tilde{v}_i,\Delta v) \,.
\end{equation}
Imposing normalisation of the speed distribution, we obtain the following constraint on the \(\{g_i\}\):
\begin{equation}
\label{eq:Speed:Normg}
\sum_{i = 1}^N g_i \, \left[(\tilde{v}_i + \Delta v)^3 - \tilde{v}_i^3\right]/3 = 1 \,.
\end{equation}
For notational convenience, we also define
\begin{equation}
\hat{g}_i = g_i \, \left[(\tilde{v}_i + \Delta v)^3 - \tilde{v}_i^3\right]/3 \,,
\end{equation}
such that the normalisation condition becomes
\begin{equation}
\label{eq:Speed:ghat}
\sum_{i = 1}^N \hat{g}_i = 1.
\end{equation}

We illustrate the form of this binned distribution for $f(v)$ in Fig.~\ref{fig:Speed:BinApprox}. We show the Standard Halo Model in the Earth frame (blue line) as well as the binned approximation to the SHM (red line). This approximation is obtained by integrating the WIMP speed distribution over each of the bins:

\begin{equation}
\label{eq:Speed:gapprox}
\hat{g}_i^\textrm{approx} = \int_{\tilde{v}_i}^{\tilde{v}_i + \Delta v} f_1^{\textrm{SHM}}(v) \, \mathrm{d}v\,.
\end{equation}
This allows us to examine how closely the binned parametrisation can be used to approximate the SHM. However, in a realistic scenario, these bin parameters $\left\{\hat{g}_i\right\}$ would form part of the parameter space, along with \mchi and $\sigma_p$, which must be explored based on the data.

\begin{figure}[h]
\centering
  \includegraphics[width=0.75\textwidth]{Speed/BinnedApprox.pdf}
  \caption[Binned approximation to the SHM]{Binned approximation to the SHM in the Earth frame. The bin heights are obtained from Eq.~\ref{eq:Speed:gapprox}. We note that shown here is $f(v)$, the directionally-averaged velocity distribution. We must multiply by $v^2$ to obtain the speed distribution $f_1(v)$.}
  \label{fig:Speed:BinApprox}
\end{figure}

In Ref.~\cite{Peter:2011}, Peter found evidence that this method still leads to a bias in the reconstructed WIMP mass and cross section, despite the apparent generality of this binned distribution function. Increasing the number of speed bins did not appear to alleviate this problem. Here, we explore this method further. In particular, we consider a large number of realisations of data sets from hypothetical future experiments, assuming some fiducial benchmark model. We then attempt to reconstruct the WIMP mass for each realisation, allowing us to determine how the method performs statistically and whether the bias found by Peter is present in all data sets or only in a small number of Poissonian realisations.


\subsection{Experiments and benchmark parameters}
\label{sec:Speed:Experiments}
We consider three next-generation detectors, modelled on experiments which are currently in development: XENON1T \cite{Aprile:2009a}, WArP \cite{Szelc:2009} and SuperCDMS \cite{Bruch:2010}. Each experiment is characterised by the (suitably averaged) mass number $A$ of the target nucleus, a fiducial detector mass \(m_\textrm{det}\), an efficiency $\epsilon$, and a pair of energies, \(E_\textrm{min}\) and \(E_\textrm{max}\), which mark the extent of the signal region. The efficiency of each experiment incorporates information about detection efficiency, as well as data cuts and detector down-time. Table \ref{tab:Speed:Expts} shows the experimental parameters used in this chapter, which are chosen to approximately match those used by Peter \cite{Peter:2011}. For all three experiments, we assume an exposure time of $t_\textrm{exp} = \textrm{ 1 year}$.

%\begin{table}[t]
%  \begin{center}
%    \begin{tabular}{lm{2cm}m{2.1cm}m{1.7cm}}
%    \hline\hline
%    & XENON1T \cite{Aprile:2009a} & SuperCDMS \cite{Bruch:2010} & WArP \cite{Szelc:2009} \\
%\hline
%Detector Target & Xe & Ge & Ar \\
%Nuclear Mass, \(m_\textrm{N} / \textrm{amu}\) & 131 & 73 & 40 \\
%Detector Mass, \(m_\textrm{det} / \textrm{kg} \) & 1000  & 100 & 1000 \\
%Exposure Time, \(t_\textrm{exp} / \textrm{days} \) & 60.8  & 109.5 & 365\\
%Energy Range, \(\left[E_\textrm{min},E_\textrm{max} \right] / \textrm{keV}\) & [2,30] & [10,100] & [30,130] \\
%    \hline\hline
%    \end{tabular}
%  \end{center}
% \caption[Parameter values for the three mock experiments used in Chapter \ref{ch:Speed}]{Parameter values for the three mock experiments used in this chapter, chosen to closely match those used in Ref.\ \cite{Peter:2011}. The meanings of the experimental parameters are described in Sec.\ \ref{sec:Speed:Experiments}.}
%\label{tab:Speed:Expts}
%\end{table}

\begin{table}[t]
  \setlength{\extrarowheight}{2pt}
  \begin{center}
    \begin{tabular}{c|m{1.2cm}m{2.2cm}m{2cm}m{2.1cm}}
    \hline\hline
    Experiment  & Target Mass, $A$ & Detector Mass (fid.), $m_\textrm{det}$/kg & Efficiency, $\epsilon$ & Energy Range/keV\\
	\hline
	Xenon  & 131  & 1000 & 0.17  & 2-30 \\
	Argon  & 40  & 1000 & 1.0 & 30-130  \\
        Germanium  & 73  & 100 & 0.3  & 10-100 \\
        \hline\hline
    \end{tabular}
  \end{center}
  \caption[Parameter values for the mock experiments used in Chapter \ref{ch:Speed}]{Parameter values for the three mock experiments used in this chapter, chosen to closely match those used in Ref.\ \cite{Peter:2011}. The Xenon experiment is modelled on Xenon1T \cite{Aprile:2009a}, the Argon experiment on WArP \cite{Szelc:2009} and the Germanium experiment on SuperCDMS \cite{Bruch:2010}. An exposure of $t_\textrm{exp} = 1 \textrm{ year}$ is used for all 3 experiments. The meanings of the experimental parameters are described in Sec.\ \ref{sec:Speed:Experiments}.}
\label{tab:Speed:Expts}
\end{table}

We assume that the detector efficiency is independent of energy. We also assume perfect energy resolution and zero backgrounds. For a real experiment, these assumptions will almost certainly not hold, for example due to variations in the relative scintillation efficiency of Xenon \cite{Aprile:2009b}, but the results presented here should be viewed as a proof of principle in the ideal case.

\begin{figure}[t]
  \centering
  \includegraphics[width=0.75\textwidth]{Speed/AccessSpeeds_New.eps}
\caption[Range of accessible WIMP speeds for mock direct detection experiments]{Range of accessible WIMP speeds as a function of WIMP mass for each of the three mock experiments: XENON1T-like (solid blue), SuperCDMS-like (dashed green) and WArP-like (dot-dashed red). Each pair of lines corresponds to the maximum and minimum accessible WIMP speeds for a given experiment. The outermost dotted red lines show the accessible speeds for the adjusted parametrisation range described in Sec.~\ref{sec:Speed:MomentumMethod2}. Reproduced from Paper I \cite{Kavanagh:2012}.}
  \label{fig:Speed:Access}
\end{figure}

Figure \ref{fig:Speed:Access} shows the minimum and maximum accessible WIMP speeds for each experiment. All three experiments rapidly become insensitive to WIMPs with speeds less than \(\sim 1000 \kms\) as the WIMP mass drops below \(m_\chi \sim 10 \textrm{ GeV}\). This suggests that the experiments considered here generically have a low sensitivity to such light WIMPs, producing too few events for accurate parameter reconstruction.

For comparison with later methods, we consider here a single benchmark model: \(m_\chi = 50 \textrm{ GeV}\), $\sigmapsi = 10^{-44} \cmsq$ and the SHM (with $v_\textrm{lag} = 220 \kms$).\footnote{At the time that Ref.~\cite{Peter:2011} and Ref.~\cite{Kavanagh:2012} were published this value of the cross section had not yet been probed. However, the value $\sigmapsi = 10^{-44} \cmsq$ has since been excluded by several experiments \cite{Aprile:2012b,Akerib:2014}.} We assume that the spin-dependent contribution to the event rate is negligible, as the $A^2$ enhancement leads the SI rate to dominate for heavy targets. This also allows us to disentangle degeneracy between \sigmapsi and \sigmapsd from the astrophysical uncertainties we consider here. We assume a fixed value for the local DM density $\rho_0 = 0.3 \textrm{ GeV cm}^{-3}$. As will be explained in Sec.~\ref{sec:Speed:MomentumMethod2}, the precise values of \sigmapsi and \(\rho_0\) are not particularly important due to the degeneracy between these two parameters. The total number of events from all three detectors combined typically ranges from around 300 to 600 for the different benchmark parameters which will be considered in this chapter.

\subsection{Parameter reconstruction}
We generate 250 mock data sets using the experiments described above. Each realisation of the mock data is generated as follows:

\begin{enumerate}
\item Calculate the number of expected events $N_e$, given $\left\{m_\chi, \sigmapsi, f(v)\right\}$, using Eq.~\ref{eq:DD:N_expected},
\item Pick the number of observed events $N_o$ from a Poisson distribution with mean $N_e$,
\item Pick recoil energies $\left\{E_1, E_2, ..., E_{N_o}\right\}$, from the distribution $P(E_R)$ 
\begin{equation}
P(E_R) = \frac{\epsilon m_\textrm{det} t_\textrm{exp}}{N_e}\dbd{R}{E_R}\,,
\end{equation}
\item Repeat for all three experiments.
\end{enumerate}

 We then use the Markov Chain Monte Carlo (MCMC) package \cosmomc \cite{Lewis:2002} to make parameter inferences on the parameters $\mchi, \sigmapsi, \left\{\hat{g}_i\right\}$, where $\hat{g}_i$ are the bin parameters for a 5 bin speed distribution function. We sample the WIMP mass and cross-section logarithmically in the ranges \([10, 1000] \textrm{ GeV}\) and \([10, 10000] \times 10^{-47} \textrm{ cm}^2\) respectively, with log-flat priors on both. We sample the $\hat{g}_i$ linearly in the range $[0,1]$, subject to the normalisation constraint of Eq.~\ref{eq:Speed:ghat}. In order to ensure adequate exploration of the parameter space, we perform the MCMC at a temperature $T=2$. That is, we explore the high temperature likelihood $\mathcal{L}^{1/T}$ and subsequently `cool' the chains back down to $T=1$ (see Appendix~\ref{ch:ParamRecon} for more details). We sample using a total of $3 \times 10^5$ chain positions, which is then thinned by a factor of 50.

The likelihood function used to generate the Markov chains is the same unbinned form used by CDMS \cite{Ahmed:2009b} and XENON100 \cite{Aprile:2011}, which for a single experiment is:
\begin{equation}
\label{eq:Speed:unbinnedL}
\mathcal{L}_1 = \frac{N_\textrm{e}^{N_\textrm{o}}\, \textrm{e}^{-N_\textrm{e}}}{N_\textrm{o}!} \, \prod_j^{N_\textrm{o}} P(E_j).
\end{equation} 
The full likelihood \(\mathcal{L}\) is then the product of the likelihoods for the three separate experiments.

The distribution of MCMC chain positions gives the posterior probability distribution $\mathcal{P}(\mathbf{\theta})$ for the parameters $\mathbf{\theta}$. In order to obtain 1-dimensional parameter limits, we consider the marginalised posterior distribution $\mathcal{P}_m(\theta)$, which is obtained by integrating $\mathcal{P}(\mathbf{\theta})$ over all the parameters other than the parameter of interest. We take the mode of the marginalised distribution as a best estimate of the underlying parameter. We then construct highest-density credible intervals for the parameter of interest at the $p\%$ level. Further details of this procedure are given in Appendix~\ref{ch:ParamRecon}. 

\subsection{Results}
Figure~\ref{fig:Speed:Speed_MassFit} shows the fitted values for the WIMP mass, \(m_\textrm{rec}\), obtained from 250 mock datasets. This distribution shows a peak around 45 GeV, as well as a significant number of datasets reconstructed at \(\sim 100 \textrm{ GeV}\). As pointed out by Ref.\ \cite{Strege:2012}, some mock datasets will not be representative of the underlying benchmark parameters, having more events at high energies than expected, for example. This can lead to `bad' reconstructions with a fitted WIMP mass higher than the benchmark value. Thus, the reconstructions near \(100 \textrm{ GeV}\) do not necessarily signify a failure of the reconstruction method.

 \begin{figure}[t]
\centering
  \includegraphics[width=0.75\textwidth]{Speed/Speed_MassFit.eps}
  \caption[Distribution of reconstructed WIMP masses using the binned speed parametrisation]{WIMP masses reconstructed using the binned speed parametrisation method from 250 realisations. The benchmark speed distribution is the SHM. The true mass of 50 GeV is shown as a dashed vertical line. Reproduced from Paper I \cite{Kavanagh:2012}.}
  \label{fig:Speed:Speed_MassFit}
\end{figure}

However, we can also study the coverage of the $p\%$ credible intervals: the fraction of reconstructions for which the true WIMP mass lies within the $p\%$ interval. For the 68\% and 95\% confidence intervals, this method shows significant under-coverage: \(36 \pm 3 \%\) coverage and \(63 \pm 3 \%\) coverage respectively. This indicates that while the mass reconstructions appear to be distributed close to the true value (within around 5-10 GeV), the corresponding error estimates must be too small.  The bias noted by Peter is therefore a real effect and is sizeable compared to the statistical uncertainty on $m_\chi$. We therefore cannot trust the WIMP mass reconstructed using this parametrisation.

\begin{comment}
We can also assess the performance of the method by calculating the `pull' statistic \(\Delta\) (see e.g.\ Ref.\ \cite{Pulls}),
\begin{equation}
\Delta = \frac{m_\textrm{rec} - m_\textrm{true}}{\sigma} \,,
\end{equation}
where \(m_\textrm{rec}\) and \(m_\textrm{true}\) are the reconstructed and true values of the WIMP mass respectively. An estimate of the uncertainty on $m_\chi$ is given by $\sigma$, which we estimate from the standard deviation of $m_\chi$ within a chain. The \(\Delta\) statistic quantifies the statistical deviation of the reconstruction from the true value. For a large number of mock datasets, the distribution of \(\Delta\) should have a mean of zero and a standard deviation of unity. \note{I'm actually using the marginalised distributions, am I?}

Figure \ref{fig:Speed:Speed_Delta} shows the \(\Delta\) distribution for the 250 realisations of this method. The standard deviation of \(\Delta\) is \(\sigma_\Delta = 3.5\), which is significantly greater than unity, showing that the speed parametrisation method significantly underestimates the errors on reconstructed values. As demonstrated in Ref.\ \cite{Peter:2011}, the problem of poor reconstructions using this method does not appear to be significantly improved by increasing the number of bins in the speed parametrisation and worsens for more complicated speed distributions.

 \begin{figure}[t]
\centering
  \includegraphics[width=0.75\textwidth]{Speed/Speed_Delta.eps}
  \caption[Distribution of the pull statistic $\delta$ using the binned speed parametrisation]{Distribution of the $\Delta$ statistic, defined in the text, for 250 realisations using the speed parametrisation method. The benchmark speed distribution is the SHM, with a 50 GeV WIMP.}
  \label{fig:Speed:Speed_Delta}
\end{figure}
\end{comment}


Figure~\ref{fig:Speed:Speed_Recon} shows the reconstructed speed distribution for a typical realisation using this method. The reconstructed mass is $m_\textrm{rec} = 30.2^{+4.5}_{-3.9} \textrm{ GeV}$, compared to the benchmark value of 50 GeV. The mean inverse speed is under-estimated in the range \(0 - 200 \kms\) and slightly over-estimated at higher speeds. However, the reduced \(m_\textrm{rec}\) increases the minimum accessible speed of the experiments, meaning that the experiments are less sensitive to the shape of the speed distribution at low speeds. Moreover, a reduced value of the reconstructed mass serves to steepen the spectrum, reconciling the flattened \(\eta(v_\textrm{min})\) at high speeds with the data. This is because varying the mass of the WIMP `rescales' the spectrum, due to the relation \(E_\textrm{R} \propto \mu_{\chi N}^2 v_{\textrm{min}}^2\).


 \begin{figure}[t]
\centering
  \includegraphics[width=0.75\textwidth]{Speed/Speed_Recon.eps}
\caption[Reconstructed speed distribution and mean inverse speed using the binned speed parametrisation]{Reconstructed speed distribution, $f(v)$, and mean inverse speed, $\eta(v)$, using the speed parametrisation method. The benchmark model used was a 50 GeV WIMP with an SHM speed distribution. The upper panel shows the underlying SHM speed distribution (solid blue) and the fitted values of the speed bin parameters (red points). The lower panel shows the mean inverse speed corresponding to these fitted values (dashed red line) and the true mean inverse speed (solid blue). Reproduced from Paper I \cite{Kavanagh:2012}.}
  \label{fig:Speed:Speed_Recon}
\end{figure}

 \begin{figure}[t]
\centering
  \includegraphics[width=0.75\textwidth]{Speed/Compare.eps}
\caption[Reconstructed mean inverse speed for the SuperCDMS-like experiment]{The rescaled mean inverse speed, \(\eta/m_\chi\), measured in the SuperCDMS-like experiment as a function of recoil energy, \(E_\textrm{R}\). The same mock dataset was used as in Fig.\ \ref{fig:Speed:Speed_Recon}. The underlying Standard Halo Model distribution (solid blue) uses the true WIMP mass of 50 GeV, as does the binned approximation to the SHM (dashed red). The reconstructed mean inverse speed (dot-dashed black) uses the reconstructed value of 30 GeV. Reproduced from Paper I \cite{Kavanagh:2012}.}
  \label{fig:Speed:Compare}
\end{figure}


In Fig.\ \ref{fig:Speed:Compare}, we plot \(\eta/m_\chi\) as a function of recoil energy, \(E_\textrm{R}\), for the SuperCDMS-like experiment. We rescale \(\eta\) by \(1/m_\chi\) because this factor appears in the event rate and we are then able to compare the spectra of events from different models. The solid line shows the mean inverse speed in the SHM, using the true WIMP mass of 50 GeV. We also show a binned approximation to the SHM (dashed line) obtained using the `true' values of the bin parameters \(\{g_i^\textrm{approx}\}\) and the true WIMP mass. Finally, we show the reconstructed mean inverse speed (dot-dashed line) using the reconstructed WIMP mass of 30 GeV. We see that the binned approximation to the SHM, which should represent a `good' reconstruction, actually recovers the spectrum poorly compared to the reconstructed values. In particular, we note the energy range of the experiment spans two bins in the binned approximation to the SHM, but three bins in the MCMC reconstruction, allowing a closer approximation to the true spectrum.

Thus, the reconstructed mass and speed distribution parameters may provide a good fit to the data, despite not being close to the underlying benchmark parameters. As can be seen from Fig.\ \ref{fig:Speed:Compare}, for a fixed bin width in velocity space, the size of bins in energy space can be reduced by moving to lower masses. This increases the number of energy bins within the sensitivity range of the experiments. This should allow a closer fit to the data and may explain why there appears to be a bias towards lower mass values. In the next section, we explore a possible way to reduce this bias by attempting to decouple the size of the bins from the value of $m_\chi$.


\section{Momentum parametrisation for a single experiment}
\label{sec:Speed:MomentumMethod1}


When considering the speed distribution of the WIMPs, we see that each experiment has a different range of sensitivity and that varying the WIMP mass changes this range. However, we can instead consider a `reduced WIMP-nucleus momentum',
\begin{equation}
\textbf{p}_N = \mu_{\chi N} \textbf{v} \,,
\end{equation}
defined separately for each target nucleus. We now note that the accessible range in \(\textbf{p}_N\) for each experiment is independent of the WIMP mass:
\begin{equation}
p_\textrm{min}(E_R) = \mu_{\chi N} v_\textrm{min}(E_R) = \sqrt{\frac{m_N E_R}{2}} \,.
\end{equation}

We therefore rewrite the differential event rate in terms of the new momentum variable:
\begin{equation}
\frac{\textrm{d}R}{\textrm{d}E_R} = \frac{\rho_0 \sigmapsi \mu_{\chi N}}{2 \mu_{\chi p}^2 m_\chi} A^2 F^2(E_R) \tilde{\eta}(p_{\textrm{min}})\,,
\end{equation}
where \(\tilde{\eta}\) is the mean inverse \textit{momentum} associated with the reduced momentum distribution, \(\tilde{f}(\textbf{p})\):
\begin{equation}
\tilde{\eta}(p_{\textrm{min}}) = \int_{p_{\textrm{min}}}^\infty \frac{\tilde{f}(\textbf{p})}{p}\, \textrm{d}^3\textbf{p} = \frac{1}{\mu_{\chi N}}\eta(p_\textrm{min}/\mu_{\chi N}).
\end{equation}
The event rate can be rewritten as:
\begin{equation}
\frac{\textrm{d}R}{\textrm{d}E_R} = \frac{\rho_0}{2} D'(\sigmapsi,m_\chi,m_N) A^2 F^2(E_R) \tilde{\eta}(p_{\textrm{min}}) \,,
\end{equation}
where we have defined
\begin{equation}
D'(\sigmapsi,m_\chi,m_N) = \frac{\sigmapsi \mu_{\chi N}}{\mu_{\chi p}^2 m_\chi} \,,
\end{equation}
which encodes all information about the WIMP mass and cross-section and controls the overall scale of the event rate.

If we consider only a single experiment, is it possible to parametrise \(\tilde{f}(\mathbf{p})\) and therefore reconstruct the value of $D'$? We can again define a directionally averaged momentum distribution, \(\tilde{f}(p) = f(p/\mu_{\chi N})/\mu_{\chi N}^3\), and parametrise this in terms of 5 constant bins, with bin values \(\{h_i\}\). It is then only necessary to parametrise \(\tilde{f}(p)\) over the range of sensitivity of the experiment: \(p \in \left[p_a, p_b\right]\), where \(p_{a,b} = p_\textrm{min}(E_\textrm{min,max})\). This means that we need not make any assumptions about the distribution function outside the range of sensitivity of the experiment. However, we still wish to impose some normalisation constraint on the momentum distribution parameters. Each experiment now probes a well-defined (but unknown) fraction of WIMPs, \(\alpha_N\), given by

\begin{equation}
\alpha_N = \int_{p_a}^{p_b} f(p) \, p^2 \textrm{d}p\,.
\end{equation}
The momentum parameters are therefore normalised according to
\begin{equation}
\sum_{i = 1}^N \hat{h}_i = \alpha_N \,,
\end{equation}
where \(\hat{h}_i\) is defined analogously to \(\hat{g}_i\) in Eq.\ \ref{eq:Speed:ghat}. We absorb the unknown \(\alpha_N\) into \(D'\), such that the momentum distribution parameters, \(\{\hat{h}_i/\alpha_N\}\), are normalised to unity and we define

\begin{equation}
\label{eq:Speed:D}
D(\sigmapsi,m_\chi,m_N) =  \alpha_N D'(\sigmapsi,m_\chi,m_N) =\alpha_N \frac{\sigmapsi \mu_{\chi N}}{\mu_{\chi p}^2 m_\chi}\,.
\end{equation}

Finally, it is necessary to introduce a parameter \(A\) which models the constant contribution to \(\eta\) from WIMPs with momenta greater than \(p_b\):

\begin{equation}
A = \int_{p_b}^\infty \frac{\tilde{f}(\textbf{p})}{p}\, \textrm{d}^3\textbf{p}\,.
\end{equation}
Because the precise form of \(\tilde{f}(p)\) above the upper energy threshold is undetermined by the experiment, the contribution of \(A\) to the normalisation, \(\alpha_N\), cannot be calculated and is therefore not considered. Instead, we include conservative constraints on \(A\) such that its contribution alone cannot exceed the normalisation of \(\tilde{f}(p)\):
\begin{equation}
A < (p_b)^{-1}.
\end{equation}
We also note that
\begin{equation}
\int_{p_a}^{p_b} \frac{\tilde{f}(\textbf{p})}{p} \, \textrm{d}^3\textbf{p} \leq \frac{\alpha_N}{p_b} \,,
\end{equation}
and thus impose the following additional constraint on the parameters:
\begin{equation}
\frac{1}{\alpha_N}\left[\eta(p_a) - \eta(p_b)\right] \leq \frac{1}{p_b}\,.
\end{equation}

We therefore perform parameter reconstructions using the parameters \(D\), \(\{h_i/\alpha_N\}\) and \(A/\alpha_N\). Because the fraction of high momentum WIMPs is expected to be relatively low, we sample the parameter \(A\) logarithmically, with a log-flat prior.

\subsection{Results}

We consider again a single set of benchmark parameters, namely a \(50 \textrm{ GeV}\) WIMP with a SHM speed distribution. We apply the momentum parametrisation to mock datasets from the WArP-like Argon experiment. The reconstructed \(D\) values, \(D_\textrm{rec}\),  are shown in Fig.\ \ref{fig:Speed:Argon1} in units of \(10^7 \textrm{ cm}^2 \textrm{ kg}^{-2}\). In all reconstructions, the posterior distribution is unimodal, having separate parameters to describe the scale (\(D\)) and shape (\(\{h_i\}\)) of the event rate. The number of reconstructions is peaked at the correct value. The average reconstructed value is \(\log_{10}(D_\textrm{rec}) = 1.865 \pm 0.004\), compared to the input value of \(\log_{10}(D_\textrm{true}) = 1.878\). This represents a slight bias (of less than \(1\%\)) towards smaller values of \(\log_{10}(D)\).

However, this is smaller than the typical statistical uncertainty in a single reconstruction, which is \(\sim 4\%\). In addition, this method results in \textit{over}coverage of the true parameter, with values of \(76 \pm 2 \%\) and \(98 \pm 1\%\) respectively for the \(68\%\) and \(95\%\) confidence intervals. This method therefore allows us to place reliable conservative estimates on the parameter \(D\).

\begin{figure}[t]
\centering
  \includegraphics[width=0.75\textwidth]{Speed/Argon1.eps}
  \caption[Distribution of the reconstructed scale parameter, $D_\textrm{rec}$, for the Argon experiment using the momentum parametrisation]{Reconstructed values for the scale parameter, \(D_\textrm{rec}\), for the Argon experiment using the momentum parametrisation method from 250 realisations. The benchmark speed distribution is the SHM. The value of \(D_\textrm{true} = 75.6 \times 10^7 \textrm{ cm}^2 \textrm{ kg}^{-2}\) is shown as a dashed vertical line. Reproduced from Paper I \cite{Kavanagh:2012}.}
   \label{fig:Speed:Argon1}
\end{figure}

We show in Fig.\ \ref{fig:Speed:Ar_Momentum} the reconstructed momentum distribution and mean inverse momentum for a typical realisation, for which $\log_{10}(D_\textrm{rec}) = 1.81_{-0.05}^{+0.09}$. The underlying momentum distribution has been rescaled by \(1/\alpha_\textrm{Ar}\) to allow a comparison to the reconstructed values. We see that the the momentum distribution is well reconstructed and the mean inverse momentum is accurately recovered at low and high momenta. In the middle of the momentum range, however, \(\tilde{\eta}(p_\textrm{min})\) exceeds the true value. Because only a single experiment is being used, the measured spectrum is particularly susceptible to Poisson fluctuations. The mock dataset used here has a slight excess of events around \(E_\textrm{R} \approx 60 \textrm{ keV}\), corresponding to \(p_\textrm{Ar} \approx 30 \textrm{ MeV}\), which may explain the reconstructed excess.

 \begin{figure}[t]
\centering
\includegraphics[width=0.75\textwidth]{Speed/Ar_momentum.eps}
\caption[Reconstructed momentum distribution for a single Argon experiment using a benchmark of a 50 GeV WIMP and the SHM]{Reconstructed momentum distribution for a single Argon experiment using a benchmark of a 50 GeV WIMP and the SHM.  The upper panel shows the SHM momentum distribution (solid blue) and reconstructed bin values (red points). Because the posterior is unimodal, we also display vertical errorbars showing the extent of the 68\% confidence region for each bin. Note that these errors are strongly correlated. The lower panel shows the corresponding reconstructed mean inverse momentum (dashed red) and the mean inverse momentum in the SHM (solid blue). The underlying distribution has been rescaled by \(1/\alpha_{\textrm{Ar}}\) for comparison to the reconstructed values. Reproduced from Paper I \cite{Kavanagh:2012}.}
  \label{fig:Speed:Ar_Momentum}
\end{figure}


In addition, this may be a consequence of the particular parametrisation. The constant-bin parametrisation of \(\tilde{f}(p)\) leads to a parametrised \(\tilde{\eta}(p_\textrm{min})\) which is concave downwards in each bin, while the underlying function is strictly convex downwards in this region. Thus, \(\tilde{\eta}(p_\textrm{min})\) tends to be slightly overestimated, leading the scale parameter \(D\) to be reduced to compensate for this. With datasets containing more events, the number of bins could be increased, in order to reduce this bias on \(D\) and maintain it at below the level of the statistical uncertainty.


\section{Momentum parametrisation for several experiments}
\label{sec:Speed:MomentumMethod2}

The reduced momentum method allows us to extract information from a single experiment, making no assumptions about the underlying velocity (or momentum) distribution. However, information about the mass and cross-section are encoded in the parameter, \(D\), and cannot be extracted using a single experiment alone. We now extend the method to use data from several detectors.

Because a different momentum variable \(p_N\) can be defined for each experiment, it is necessary to choose a single experiment and parametrise the momentum distribution defined with respect to that experiment. It may be necessary to adjust the lower and upper limits of the parametrisation (beyond the values of \(E_\textrm{min}\) and \(E_\textrm{max}\) used in the experiment) to accommodate as much of the data as possible from all experiments. In the single experiment considered in Section \ref{sec:Speed:MomentumMethod1}, the WIMP-Ar momentum was parametrised in the range \(p_\textrm{Ar} \in \left[23.6, 49.2\right] \textrm{ MeV}\), to match the sensitivity of the Argon experiment. However, as can be seen in Fig.\ \ref{fig:Speed:Access}, this sensitivity window does not match that of the other experiments. If we extend this interval, and parametrise in the range \(p_\textrm{Ar} \in \left[3.6, 53.0\right] \textrm{ MeV}\), we can enclose the sensitivity regions of all three experiments as closely as possible, as shown by the dotted curves in Fig.\ \ref{fig:Speed:Access}. We again use 5 bins in momentum space, with an additional parameter to control a constant offset.

In theory, any of the three experiments could have been chosen to define the momentum variable. However, some choices of experiment are less practical. For example, in order to use the XENON1T-like experiment, it would be necessary to parametrise the momentum over the range \(p_\textrm{Xe} \in \left[11 , 162\right] \textrm{ MeV}\). This is because at high WIMP masses the remaining two experiments have maximum accessible speeds of \(\sim 500 \kms\). This corresponds to very high values of the WIMP-Xe reduced momentum because of Xenon's comparatively higher mass. A large number of bins would be required to cover this wide momentum range and accurately model structures in the distribution function. Owing to the Galactic escape speed, many of these bins would have a value of zero, making parametrisation with respect to the XENON1T-like experiment a poor choice.

%Different numbers of bins

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%----Think carefully about this - in particular, make sure the explanation is tip top - we want to keep the number of bins probed by each experiment constant (as we vary the WIMP mass). 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

By comparison, using the WArP-like Argon experiment allows us to parametrise only as much of the momentum space as required to accommodate data from all three experiments. In the speed parametrisation method, varying the WIMP mass altered the size and number of energy bins to which the experiments were sensitive. However, for a given range of reduced WIMP-Argon momenta, the corresponding energy range probed by each experiment depends less strongly on $m_\chi$ (and is independent of $m_\chi$ for the Argon experiment itself). This means that the number of bins probed by each experiment should not vary significantly as a function of WIMP mass. For a fixed bin width in momentum space, the bin width in energy space is also much less sensitive to the WIMP mass. This should help reduce the bias observed in the binned speed parametrisation.

Unfortunately, this method does not allow the WIMP-nucleon cross-section to be extracted; because the contributing WIMP fraction, \(\alpha\), is unknown, we can only obtain a lower bound. This is a fundamental limitation of any method which makes no assumptions about the underlying speed distribution. Without knowing the fraction of WIMPs with speeds within the signal window of the experiment, we cannot determine the cross-section. However, the cross-section appears in the event rate only through the degenerate combination \(\sigma_p \rho_0\). As discussed in Sec.~\ref{sec:DD:astrounc}, estimates of $\rho_0$ typically carry a factor of around 2 uncertainty. Thus, any estimate of the WIMP-nucleon interaction cross-section would have an inherent uncertainty in any case.

\subsection{Results}

We first compare results for the momentum method to the speed parametrisation method described in Section \ref{sec:Speed:binned}. We use the same mock datasets generated for the \(50 \textrm{ GeV}\), SHM benchmark presented previously. The results of both the momentum and speed methods are shown in Fig.\ \ref{fig:Speed:both}. In the case of the momentum method, the distribution of realisations is now more closely peaked around the true mass of \(50 \textrm{ GeV}\). Furthermore, the momentum method produces substantially improved coverage properties, as summarised in Table \ref{tab:CoverageComparison}. It should be noted that compared to the speed method, the momentum method leads to a larger number of reconstructions at high WIMP mass. It is not clear whether this signals a failure of the momentum method in certain cases or whether these are representative of `bad' reconstructions, as will be discussed shortly.

Figure~\ref{fig:Speed:50SHM_momentum} shows the reconstructed WIMP-Argon momentum distribution using the same mock dataset as used for Fig.\ \ref{fig:Speed:Speed_Recon}. The benchmark distributions have been rescaled by \(\alpha\) so that they can be compared to the reconstructed values. In this case, \(\alpha = 0.995\), so we can reconstruct both the mass and cross section accurately: \(\log_{10} (m_\textrm{rec} / \textrm{ GeV}) = 1.62 \pm 0.31\) and \(\log_{10} (\sigma_p / 10^{-47} \textrm{ cm}^2) = 2.99 \pm 0.18\), compared to the true values of \(\log_{10} (m_\textrm{true} / \textrm{ GeV}) = 1.699\) and \(\log_{10} (\sigma_p / 10^{-47} \textrm{ cm}^2) = 3.0\). While there is no way to know \textit{a priori} whether \(\alpha\) will be close to unity, the accurate reconstruction of the mass, cross-section and momentum distribution show that momentum parametrisation can offer a significant improvement over the speed parametrisation method.

\begin{figure}[t]
\centering
  \includegraphics[width=0.75\textwidth]{Speed/Both.eps}
  \caption[Comparison of WIMP masses reconstructed using the binned speed and momentum parametrisations]{WIMP masses reconstructed using the speed and momentum parametrisation methods from 250 realisation. The benchmark speed distribution is the SHM. The true mass of 50 GeV is shown as a dashed vertical line. Reproduced from Paper I \cite{Kavanagh:2012}.}
  \label{fig:Speed:both}
\end{figure}

\begin{figure}[t]
\centering
  \includegraphics[width=0.75\textwidth]{Speed/50SHM_momentum.eps}
\caption[Reconstructed momentum distribution from all three mock experiments using a benchmark of a 50 GeV WIMP and the SHM]{Reconstructed momentum distribution from all three mock experiments using a benchmark of a 50 GeV WIMP and the SHM. The upper panel shows the SHM momentum distribution (solid blue) and reconstructed bin values (red points). The lower panel shows the corresponding reconstructed mean inverse momentum (dashed red) and the mean inverse momentum in the SHM (solid blue). The reconstructed values have been rescaled by \(\alpha\) for comparison to the true distribution. Reproduced from Paper I \cite{Kavanagh:2012}.}
  \label{fig:Speed:50SHM_momentum}
\end{figure}

\begin{table}[t]
  \begin{center}
    \begin{tabular}{ccc}
    \hline\hline
    & Speed Method & Momentum Method \\
    \hline
    68\% Coverage & \(36 \pm 3 \%\) & \(71 \pm 3 \%\) \\
    95\% Coverage & \(63 \pm 3\%\) & \(92 \pm 2 \%\) \\
    \hline\hline
    \end{tabular}
  \end{center}
  \caption{Confidence interval coverage results for the speed and momentum parametrisation methods for a 50 GeV SHM benchmark model.}
\label{tab:CoverageComparison}
\end{table}

We now present the results of the momentum method for a wider range of benchmarks. In order to ensure the robustness of the method, we use two possible WIMP masses of 50 GeV and 100 GeV, as well as three benchmark models for the velocity distribution:

\begin{enumerate}[(i)]
\item the Standard Halo Model (SHM), with \(\sigma = 156 \kms\) and \(v_\textrm{lag} = 220 \kms\);
\item a 50\% Standard Halo Model with a 50\% contribution from a dark disk (SHM+DD);
\item rescaled Via Lactea II data (VL-2).
\end{enumerate}

We model the dark disk velocity distribution as a Maxwellian with \(\sigma = 50 \kms\) and \(v_\textrm{lag} = 60 \kms\), similar to the typical values obtained by Ref.\ \cite{Purcell:2009}. A 50\% contribution from the dark disk is at the upper limit of the range presented by Ref.\ \cite{Read:2010} and we consider this as an extreme case. The third benchmark is the distribution function as extracted from the Via Lactea 2 (VL-2) N-body simulation \cite{Diemand:2008} and presented in Ref.\ \cite{Kuhlen:2010}. It is averaged over galactic radius in the range \(7.5 < R < 9.5 \textrm{ kpc}\) and measured in bins of width \(10 \textrm{ m s}^{-1}\). VL-2 is a DM-only simulation and thus leads to a lower peak speed than the SHM. Including the effects of baryons should deepen the galactic potential and raise this peak speed closer to that observed in the Milky Way. In order for a fairer comparison, we therefore rescale the VL-2 data such that \(f_1(v)\) peaks at the same speed as in the SHM, allowing us to probe the departures from Maxwellian form which appear in N-body simulations.

%These benchmark velocity distributions are illustrated in Fig. \ref{fig:Speed:benchmarkf}. The VL-2 data has the flattest velocity distribution with a tail extending beyond \(800 \kms\). This leads to a flatter spectrum and a larger number of events at higher energies than for the other two benchmark models. The SHM distribution produces roughly the same number of events as the VL-2 distribution, but with fewer events at high energy. In the dark disk model, however, the value of \(v_\textrm{lag}\) is much smaller. This means that WIMPs typically have much lower speeds and many have insufficient energy to overcome the thresholds of the detector. This results in fewer observed events and a steeper recoil spectrum.

\begin{comment}
 \begin{figure}[t]
\centering
\includegraphics[width=0.75\textwidth]{Speed/speed_examples.eps}
\caption[Speed distributions and mean inverse speeds for the Standard Halo Model (SHM), SHM + Dark disk (SHM+DD) and Via Lactea 2 (VL-2) distribution functions]{1-D and 3-D speed distributions, \(f(v)\) and \(f_3(v)\), \note{Fix...} and mean inverse speed, \(\eta(v)\), for the 3 benchmark speed models with parameter values as given in Sec.\ \ref{sec:ParamBenchmarks} : Standard Halo Model (SHM - solid blue), Standard Halo Model + Dark Disk (DD - dashed green) and Via Lactea 2 (VL-2 - dotted red). \note{Fix this notation...}}
  \label{fig:Speed:benchmarkf}
\end{figure}
\end{comment}

The distributions of reconstructed masses are shown in Fig.\ \ref{fig:Speed:recons50} for the 50 GeV WIMP and Fig.\ \ref{fig:Speed:recons100} for the 100 GeV WIMP. For the 50 GeV benchmark, the distribution of reconstructions is peaked at the true value, though in all three cases there are a number of datasets reconstructed at higher masses. For some of the mock datasets, the posterior distribution for the WIMP mass is multimodal, with a peak near the true value as well as a peak above \(\sim 100 \textrm{ GeV}\). For reconstructions using a fixed speed (or momentum) distribution, these may correspond to `bad' reconstructions, as mentioned previously, in which the spectrum of events is flatter than expected. When the momentum distribution is allowed to vary, as here, the event rate can be well fit by more than one region of the mass parameter space.  We also note a larger number of reconstructions at high masses in the case of the VL-2 benchmark. This is because of the flatter recoil spectrum in this case, which is more easily mimicked by a higher WIMP mass.

 \begin{figure}[t]
\centering
\includegraphics[width=0.75\textwidth]{Speed/50GeV-1.eps}
\caption[Distribution of reconstructed masses using the binned momentum distribution for a 50 GeV WIMP with SHM, SHM+DD and VL2 distribution functions]{Distribution of reconstructed masses, \(m_\textrm{rec}\), using the momentum method for 250 reconstructions. The true mass of 50 GeV is shown as a dashed vertical line. Reproduced from Paper I \cite{Kavanagh:2012}.}
  \label{fig:Speed:recons50}
\end{figure}


For the 100 GeV benchmark, the SHM and VL-2 models show similar structures, with a broad peak of reconstructions at or near the correct values, as well as a smaller tail up to masses of 1000 GeV, the upper limit of the prior. The 100 GeV datasets contain fewer events than their 50 GeV counterparts, so we would expect the spread of reconstructed values to be broader. Also, as the WIMP mass exceeds the mass of the target nucleus, \vmin becomes less sensitive to the value of the $m_\chi$ \cite{Peter:2011}. The result is that the shape of the event spectrum becomes roughly independent of the WIMP mass. The largest nuclear mass used here is \(A_\textrm{Xe} = 131\), meaning that for values of \(m_\textrm{rec}\) significantly above \(m_\chi \approx 131 \textrm{ amu} \approx 122 \textrm{ GeV}\), the posterior distribution becomes roughly flat. Reconstructions in the high-mass tail occur when the maximum of the posterior occurs in this approximately flat region, and we expect the tail to extend up to arbitrarily high masses. In this case, we can only place a lower bound on the WIMP mass and, when calculating coverage statistics, we use 1-tailed limits (i.e. a \(p\%\) confidence limit encloses \(\frac{1}{2}(1+p) \%\) of the marginalised posterior).

 \begin{figure}[t]
\centering
\includegraphics[width=0.75\textwidth]{Speed/100GeV-1.eps}
\caption[As Fig.~\ref{fig:Speed:recons50} for \(m_\chi = 100 \textrm{ GeV}\)]{As Fig.\ \ref{fig:Speed:recons50} for \(m_\chi = 100 \textrm{ GeV}\). Reproduced from Paper I \cite{Kavanagh:2012}.}
  \label{fig:Speed:recons100}
\end{figure}


We report coverage statistics for the various benchmarks in Table \ref{tab:Speed:CoverageAll}. For the SHM, there is approximately exact coverage for both 50 and 100 GeV WIMPs, while for the VL-2 benchmark exact coverage is observed for the 100 GeV WIMP. The remaining benchmark parameters display some undercoverage, though still much improved over that achieved by the speed parametrisation method. The poorest coverage is achieved for the 100 GeV SHM+DD benchmark, for which the 68\% confidence interval has a coverage of \(58 \pm 3 \%\). This is to be expected from the poorly distributed reconstructions shown in Fig.\ \ref{fig:Speed:recons100}. For the 100 GeV dark disk benchmark, there appears to be a significant bias in the distribution of reconstructed values, which peaks around \(70 \textrm{ GeV}\). We explore the origin of this bias in the next section, where we examine the speed distributions reconstructed using this method.

\begin{table}[t]
  \begin{center}
    \begin{tabular}{lll}
    \hline\hline
    & \multicolumn{2}{c}{WIMP Mass} \\
     &  50 GeV & 100 GeV \\
  \hline
     \multirow{2}{*}{ \textsc{SHM}}  & \(71 \pm 3 \%\) & \(65\pm 3 \%\)\\
				&   \(92 \pm 2 \%\) & \(94 \pm 1 \%\)\\ \\
     \multirow{2}{*} {\textsc{SHM+DD}}  & \(61 \pm 3 \%\) & \(58 \pm 3 \%\) \\
				 & \(94 \pm 1 \%\) & \(91 \pm 2 \%\) \\ \\
     \multirow{2}{*} {\textsc{VL-2}} & \(72 \pm 3 \%\) & \(65 \pm 3 \%\)\\
				& \(90 \pm 2 \%\) & \(94 \pm 2 \%\)\\

    \hline\hline
    \end{tabular}
  \end{center}
  \caption[Confidence interval coverage results for the momentum parametrisation method]{68\% and 95\% confidence interval coverage results for the momentum parametrisation method using a variety of benchmark parameters, as defined in Sec.\ \ref{sec:Speed:Experiments}.}
\label{tab:Speed:CoverageAll}
\end{table}

\subsection{Recovering the speed distribution}
\label{sec:Speed:RecoverSpeed}
We will now consider how the speed distribution can be reconstructed from the momentum parametrisation. For a set of constant bins in momentum space, the positions and widths of bins in velocity space are dependent on the WIMP mass. It is therefore difficult to extract precise statistical information on the speed distribution, as the bin values will be very strongly correlated with the WIMP mass. Instead, we take the reconstructed WIMP mass as fixed and use this to obtain a speed distribution from the momentum distribution parameters. Without treating the covariance of the WIMP mass and the bin parameters in full, the reconstructed speed distribution will depend strongly on the reconstructed mass value. However, this naive approach should give an indication of whether accurate reconstructions are possible.

First, we consider a 50 GeV WIMP with SHM distribution, as an archetypal WIMP model with a well-behaved distribution function. We show a typical reconstructed speed distribution in Fig.\ \ref{fig:Speed:SHM50}, using the same mock dataset as Fig.\ \ref{fig:Speed:50SHM_momentum}. In this case, the reconstructed value of \(m_\textrm{rec}\) is 42 GeV and the speed distribution appears to be accurately reconstructed within the error estimates.

 \begin{figure}[t]
\centering
\includegraphics[width=0.75\textwidth]{Speed/50SHM_speeds.eps}
\caption[Reconstructed speed distribution from all three mock experiments using the momentum parametrisation method for a 50 GeV WIMP and SHM distribution function.]{Reconstructed speed distribution from all three mock experiments using the momentum parametrisation method. The benchmark is a 50 GeV WIMP and the SHM distribution function. The upper panel shows the underlying SHM speed distribution (solid blue) and the fitted values of the speed bin parameters (red points). The lower panel shows the mean inverse speed corresponding to these fitted values (dashed red line) and the true mean inverse speed (solid blue). The underlying distributions have been rescaled by \(\alpha\) for comparison to the reconstructions. Reproduced from Paper I \cite{Kavanagh:2012}.}
  \label{fig:Speed:SHM50}
\end{figure}

 \begin{figure}[t]
\centering
  \includegraphics[width=0.75\textwidth]{Speed/bin_comparison.eps}
\caption[As Fig.\ \ref{fig:Speed:SHM50} for a 100 GeV WIMP with SHM+DD distribution function using 5 and 7 momentum bins]{As Fig.\ \ref{fig:Speed:SHM50} for a 100 GeV WIMP with SHM+DD distribution function using 5 momentum bins (left panels) and 7 momentum bins (right panels). Reproduced from Paper I \cite{Kavanagh:2012}.}
  \label{fig:Speed:DD100}
\end{figure}

\begin{figure}[t]
\centering
\includegraphics[width=0.75\textwidth]{Speed/100DD_7bins_masses.eps}
\caption[Distribution of reconstructed masses using the 7-bin momentum method for a SHM+DD benchmark distribution.]{Distribution of reconstructed masses using the 7-bin momentum method for 250 reconstructions for a SHM+DD benchmark distribution. The true mass of 100 GeV is shown as a dashed vertical line. Reproduced from Paper I \cite{Kavanagh:2012}.}
  \label{fig:Speed:7bins}
\end{figure}

Next, we consider a reconstruction for a 100 GeV WIMP with SHM+DD distribution function. One example is shown in the left-hand panels of Fig.\ \ref{fig:Speed:DD100}, for a dataset with reconstructed mass \(\log_{10}(m_\textrm{rec} / \textrm{GeV}) = 1.83 \pm 0.15\), compared to the true value of \(\log_{10}(m_\chi / \textrm{GeV}) = 2\). The speed distribution appears to be well recovered at all speeds. However, there is a significant discrepancy in the mean inverse speed below \(\sim 150 \kms\). This is because the SHM+DD distribution function is very rapidly varying at low \(v\), meaning that the ansatz of constant bins can no longer be applied. As observed in the speed parametrisation method, the event spectrum can be steepened by moving to lower mass values and this may explain why there is significant bias and poor coverage for this set of benchmark parameters.

In the right-hand panels of Fig.\ \ref{fig:Speed:DD100}, we show results from the same mock dataset reconstructed using 7 bins in momentum space. The reconstructed mass is now \(\log_{10}(m_\textrm{rec} / \textrm{GeV}) = 2.21 \pm 0.27\), with the mean inverse momentum more closely reconstructed than for the 5 bin case. Figure \ref{fig:Speed:7bins} shows the distribution of reconstructed masses for a 100 GeV WIMP with a SHM+DD distribution function using 7 bins in momentum space. The reconstructed masses are now more broadly distributed around the benchmark value, with improved coverage compared to the 5 bin case: \(67 \pm 3 \%\) and \(94 \pm 1 \%\). We have found that increasing the number of bins for the 50 GeV SHM benchmark leaves the coverage properties and distribution of reconstructions largely unchanged, indicating that increasing the number of bins can be used to check the robustness of the reconstructions.


Finally, we consider the discriminatory power of the reconstructions. Returning to the 50 GeV SHM benchmark, we plot a single speed distribution reconstruction in Fig.\ \ref{fig:Speed:SHM50_all}, as well as all three benchmark speed distributions for comparison. The reconstruction is reasonably consistent with both the SHM and VL-2 models and displays only mild tension with the SHM+DD model. In addition, the benchmark distributions in Fig.\ \ref{fig:Speed:SHM50_all} have been rescaled by the true value of \(\alpha\) for comparison with the reconstructed values. In a real experiment, the value of \(\alpha\) is unknown, further reducing the potential to discriminate between different models. Only in the case of more extreme distribution functions, such as a dark disk, might it be possible to make a distinction between the many possible underlying models. Thus, while the momentum parametrisation method can provide good constraints on the mass of the WIMP, it remains difficult to probe the speed distribution function.

 \begin{figure}[t]
\centering
\includegraphics[width=0.75\textwidth]{Speed/SHM50_all.eps}
\caption[Comparison of reconstructed speed distribution with three possible benchmark distributions]{Reconstructed speed distribution from all three mock experiments using a benchmark of a 50 GeV WIMP with SHM distribution. The reconstructed values have been rescaled by \(\alpha\) for comparison to the true distribution. The three different benchmark speed distributions defined in Sec.\ \ref{sec:Speed:Experiments} have been overlaid: SHM (solid blue), SHM+DD (dashed green) and VL-2 (dotted red). Reproduced from Paper I \cite{Kavanagh:2012}.}
  \label{fig:Speed:SHM50_all}
\end{figure}


\section{Discussion}
\label{sec:Speed:discussion}
We have explored the simple, empirical parametrisation proposed by Peter and showed that it produces a significant bias and underestimates the errors on $m_\chi$, even for simple benchmarks. This appears to be due to the dependence of $\eta(E_R)$ on \mchi. For a fixed bin width in $v$, reducing the WIMP mass leads to smaller bins in $E_R$. This means that $\eta(E_R)$ can provide a better fit to the observed data, as demonstrated in Fig.~\ref{fig:Speed:Compare}.

As an alternative we have proposed binning the \textit{momentum} distribution. For a single experiment, the inverse momentum distribution $\tilde{\eta}(E_R)$ is independent of the WIMP mass and the scale (controlled by the parameter $D$ of Eq.~\ref{eq:Speed:D}) and shape of the recoil distribution can be effectively decoupled. This allows $D$ to be reconstructed with minimal bias. The $D$ values from many different experiments can then potentially be used to place bounds on the values of the WIMP mass and cross-section.

However, to directly constrain the WIMP mass, it is necessary to combine data from multiple experiments simultaneously. This is done by parametrising the reduced momentum distribution of the WIMPs with respect to only one of the experiments. In this work, we choose to parametrise $p_{\chi Ar}$. The result is that the shape of the recoil spectrum depends only weakly on the WIMP mass. This is because the recoil energy can now be written as

\begin{equation}
E_R = \frac{2 p_{\chi Ar}^2}{m_N} \left(\frac{\mu_{\chi N}}{\mu_{\chi Ar}}\right)^2\,.
\end{equation}
For a fixed bin width in $p_{\chi Ar}$, the bin width in recoil energy now scales with $\mu_{\chi N}^2/ \mu_{\chi Ar}^2$, which has a weaker dependence on $m_\chi$ than when we consider fixed bins in $v$. This reduces the bias induced in the reconstructed WIMP mass.

The momentum method also allows us to probe a more constrained range of speeds. This is done by parametrising $p_{\chi Ar}$ only over the range to which the experiments are sensitive. While this cannot be done exactly for more than one experiment, it means that as many of the momentum bin parameters as possible contribute to the rate. Varying the WIMP mass does not strongly impact the number of bins to which the experiments are sensitive, again reducing bias in the reconstructed value of $m_\chi$. This is similar to the method of Drees and Shan \cite{Drees:2008}, which uses an algorithm to attempt to match the sensitivity ranges of multiple experiments.

Unfortunately, for low WIMP masses the range of speeds (and therefore momenta) probed by each experiment grows rapidly (see Fig.~\ref{fig:Speed:Access}). A significant portion of this range is expected to be significantly higher than the maximum expected WIMP speed of $\sim 800 \kms$. If we hope to parametrise the entire range of sensitivity of the experiments, this means that only a very small fraction of this range will be non-zero. A very large number of bins would be required to capture this `low' momentum population (as discussed briefly in Sec.~\ref{sec:Speed:MomentumMethod2} for the case of a Xenon experiment). Thus, the momentum binning method appears not to be feasible for low mass WIMPs. Even in the case of intermediate mass WIMPs, it may not always be clear what the optimum range of momenta will be. We have not proposed a method for determining the range of momenta to parametrise, given the experimental parameters. Instead, the momentum range must be chosen `by eye'. 

In Sec.~\ref{sec:Speed:RecoverSpeed}, we have attempted to reconstruct the WIMP speed distribution from the corresponding momentum distribution. In doing so, we fixed the WIMP mass to its reconstructed value, in order to avoid the strong correlations between $m_\chi$ and $\tilde{f}(p)$ associated with converting $p$ to $v$. However, in order to make robust statistical inferences about the speed distribution, it is necessary to take these correlations into account. This will be especially important when distinguishing between similar forms for $f(v)$, as in Fig.~\ref{fig:Speed:SHM50_all}. In future, it will be necessary to study these correlations in detail or find a parametrisation with which we can reconstruct $f(v)$ directly.

Finally, while the momentum bin parametrisation provides significant improvements in coverage and reduced bias over the speed bin parametrisation, it may not work in every scenario. For example, the method still suffers from some under-coverage for more extreme distribution functions, such as the dark disk. This can be improved by increasing the number of bins, at the cost of significantly widening the range of reconstructed masses. These residual problems mean that the momentum binning method should be applied with caution.

\section{Conclusions}
\label{sec:Speed:Conclusion}

We have discussed previous attempts to account for astrophysical uncertainties in the analysis of direct detection data. In particular, we have emphasised the need for a general, empirical parametrisation for the WIMP distribution function and we have studied one such proposal in detail: a binned parametrisation for $f(v)$, developed by Peter. We show that this method produces a significant bias in reconstructions of the WIMP mass. This parametrisation introduces a fixed scale (the bin width) into the distribution function. Converting from speed bins to energy bins depends on the WIMP mass, introducing a bias into the analysis. We propose an alternative method: a binned parametrisation of the WIMP momentum distribution.

In the case of a single experiment, this method can be applied exactly and allows one to extract information about the shape of the distribution function, at the cost of losing access to information about either the WIMP mass or cross-section separately. For multiple experiments, the range of the parametrisation must be extended to cover the sensitivity regions of all experiments. For estimation of the WIMP mass, this allows us to achieve significant improvements in coverage and reduction in bias over previous methods. Without making any assumptions about the WIMP speed distribution, however, we cannot estimate the interaction cross-section due to its degeneracy with the fraction of WIMPs accessible to the experiments. This is an unavoidable problem for any method hoping to analyse direct detection data without astrophysical assumptions.

Reconstruction of the WIMP speed distribution remains difficult. The finite sensitivity window of direct detection experiments means that information on the normalisation of \(f(v)\) is lost, making comparison to theoretical models difficult. At the event rates studied here, it does not appear to be possible to distinguish between different distribution functions. A more thorough treatment of the correlation between $m_\chi$ and the momentum bin parameters would be required for robust inferences.

This technique represents a significant step towards developing model-independent methods for determining the WIMP mass. However, caution must be exercised, as the method is expected to perform poorly for low mass WIMPs, where the range of momenta probed by the experiments is large. There is also evidence that residual bias may remain, especially in the case of more extreme distribution functions.



